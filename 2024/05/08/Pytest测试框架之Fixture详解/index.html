<!DOCTYPE html>
<html>
    <head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" name="viewport" />
  <meta name="robots" content="index, follow">
  <!-- title -->
  
    
  <title>Pytest测试框架之Fixture详解 - 无涯博客</title>
    
  
  
  <!-- open graph -->
  <meta name="description" content="The pytest framework makes it easy to write small, readable tests, and can scale to support complex functional testing for applications and libraries. 这段话很好地阐述了Pytest的设计思想与强大的特性。之前详细地阐述了Pytest测试框架搜索规则">
<meta property="og:type" content="article">
<meta property="og:title" content="Pytest测试框架之Fixture详解">
<meta property="og:url" content="http://example.com/2024/05/08/Pytest%E6%B5%8B%E8%AF%95%E6%A1%86%E6%9E%B6%E4%B9%8BFixture%E8%AF%A6%E8%A7%A3/index.html">
<meta property="og:site_name" content="无涯博客">
<meta property="og:description" content="The pytest framework makes it easy to write small, readable tests, and can scale to support complex functional testing for applications and libraries. 这段话很好地阐述了Pytest的设计思想与强大的特性。之前详细地阐述了Pytest测试框架搜索规则">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/2024/05/08/Pytest%E6%B5%8B%E8%AF%95%E6%A1%86%E6%9E%B6%E4%B9%8BFixture%E8%AF%A6%E8%A7%A3/%E6%B5%8B%E8%AF%95%E5%9B%BA%E4%BB%B6.jpg">
<meta property="og:image" content="http://example.com/2024/05/08/Pytest%E6%B5%8B%E8%AF%95%E6%A1%86%E6%9E%B6%E4%B9%8BFixture%E8%AF%A6%E8%A7%A3/%E8%BF%94%E5%9B%9E%E5%80%BC%E7%89%B9%E6%80%A7.jpg">
<meta property="og:image" content="http://example.com/2024/05/08/Pytest%E6%B5%8B%E8%AF%95%E6%A1%86%E6%9E%B6%E4%B9%8BFixture%E8%AF%A6%E8%A7%A3/%E5%8F%82%E6%95%B0%E5%8C%96.jpg">
<meta property="og:image" content="http://example.com/2024/05/08/Pytest%E6%B5%8B%E8%AF%95%E6%A1%86%E6%9E%B6%E4%B9%8BFixture%E8%AF%A6%E8%A7%A3/%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%8F%B7.jpg">
<meta property="article:published_time" content="2024-05-08T07:01:08.000Z">
<meta property="article:modified_time" content="2024-05-08T09:22:26.898Z">
<meta property="article:author" content="无涯">
<meta property="article:tag" content="Pytest测试框架">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/2024/05/08/Pytest%E6%B5%8B%E8%AF%95%E6%A1%86%E6%9E%B6%E4%B9%8BFixture%E8%AF%A6%E8%A7%A3/%E6%B5%8B%E8%AF%95%E5%9B%BA%E4%BB%B6.jpg">
  <!-- canonical -->
  
  <link rel="canonical" href="http://example.com/2024/05/08/Pytest测试框架之Fixture详解/">
  
  <!-- Favicon -->
  <link rel="shortcut icon" href="/img/favicon.ico">
  <link rel="apple-touch-icon" sizes="180x180" href="/img/apple-touch-icon.png">
  <!-- CSS -->
  
<link rel="stylesheet" href="/css/reset.css">

  
<link rel="stylesheet" href="/css/style.css">

  
<link rel="stylesheet" href="/css/markdown.css">

  
<link rel="stylesheet" href="/css/fonts.css">

<meta name="generator" content="Hexo 7.2.0"></head>

    <body>
        <div class="paper">
            <div class="paper-main">
                
                    <div class="post-header">
    <a class="logo" href="/">无涯博客</a>
    <!-- <div class="logo"><a href="/" title="Len"><img src="/img/logo.svg" alt="Len" aria-label="logo" height="20"></a></div> -->
        <ul class="nav">
            
            <li><a href="/">Home</a></li>
            
            <li><a href="/about">About</a></li>
            
            <li><a href="/archives">Archives</a></li>
            
        </ul>


    </a>
</div>

                
                <div class="post-main">
    
        <div class="post-main-title">
            Pytest测试框架之Fixture详解
        </div>
        <div class="post-meta">
            2024-05-08 ｜ 
            
        </div>
        <!-- 圆角分类 -->
        <!-- <div class="tags"> -->
            <!--  -->
        <!-- </div> -->
        <div class="post-md">
            <p>The <code>pytest</code> framework makes it easy to write small, readable tests, and can scale to support complex functional testing for applications and libraries. 这段话很好地阐述了Pytest的设计思想与强大的特性。之前详细地阐述了<a target="_blank" rel="noopener" href="http://mp.weixin.qq.com/s?__biz=MzAwMzY3MTU3Nw==&mid=2650529557&idx=1&sn=d08c59cf20f88a2f640c45b70b46c36f&chksm=8338ec63b44f657579dc7ce0db3fbe0f7ac33cd198759cd0c1daa4bd10086737804a69914a5b&scene=21#wechat_redirect">Pytest测试框架搜索规则</a>、<a target="_blank" rel="noopener" href="http://mp.weixin.qq.com/s?__biz=MzAwMzY3MTU3Nw==&mid=2650529569&idx=1&sn=81288481d0c9ef26c84169a7c0666478&chksm=8338ec57b44f65415eb9159d9b36de3df84b27b84b745f843c6f6c2850eccc788a39a33f599e&scene=21#wechat_redirect">Pytest测试框架执行方式</a>与<a target="_blank" rel="noopener" href="http://mp.weixin.qq.com/s?__biz=MzAwMzY3MTU3Nw==&mid=2650529576&idx=1&sn=930d40b06741877aba54b4f58cc35652&chksm=8338ec5eb44f6548c13ddf30b395a9cbde84e4b9cb516a694c8def876606d2c6efb05d546c05&scene=21#wechat_redirect">Pytest测试框架参数化</a>，本文章主要详细地阐述下Pytest测试框架中Fixture特性。</p>
<h1 id="Fixture测试固件特性"><a href="#Fixture测试固件特性" class="headerlink" title="Fixture测试固件特性"></a>Fixture测试固件特性</h1><p>在Pytest测试框架中Fixture最核心的特点测试固件的特性(所谓测试固件就就是执行测试用例中初始化与清理的部分)，Fixture函数测试固件主要是通过yield来进行体现的。在实际的测试实战中，这样的测试场景其实经常出现，比如查询某条数据，那么它的前置动作是添加数据，后置动作是清理数据，而前置动作与后置动作部分，就是测试固件最直接也是最典型的体现。见如下的测试代码:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"><span class="comment"># author:无涯</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span>  pytest </span><br><span class="line"></span><br><span class="line"><span class="meta">@pytest.fixture()</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">init</span>():</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&#x27;初始化&#x27;</span>)</span><br><span class="line">  <span class="keyword">yield</span> </span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&#x27;清理&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>在如上代码中定义了Fixture的函数init，这部分详细的解读具体就是：在Fixture函数init中，yield部分主要为测试步骤与测试验证部分，也就是TestCase真正被执行的逻辑部分，yield前面的代码主要是为了执行yield部分初始化的代码，yield后面的代码主要是yield代码执行后的清理操作，持续完善下代码，增加测试函数，完善后的代码如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">#! /usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"><span class="comment"># author:无涯</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span>  pytest</span><br><span class="line"></span><br><span class="line"><span class="meta">@pytest.fixture()</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">init</span>():</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&#x27;初始化&#x27;</span>)</span><br><span class="line">  <span class="keyword">yield</span></span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&#x27;清理&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test_case_001</span>(<span class="params">init</span>):</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&#x27;测试步骤与测试验证&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p><img src="/2024/05/08/Pytest%E6%B5%8B%E8%AF%95%E6%A1%86%E6%9E%B6%E4%B9%8BFixture%E8%AF%A6%E8%A7%A3/%E6%B5%8B%E8%AF%95%E5%9B%BA%E4%BB%B6.jpg" alt="测试固件"></p>
<p>在测试函数test_case_001中形式参数增加了Fixture函数init，其实本质上它是Fixture函数的对象，这样执行测试函数test_case_001后，如上截图中可以清晰的看到第一步执行的是初始化，第二部分执行的也就是测试步骤与测试验证部分，最后是清理的部分。理解了Fixture函数测试固件的特性，下面结合一个书籍管理的微服务详细的演示下它在API自动化测试中的案例应用实战，书籍微服务案例代码如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"><span class="comment"># author:无涯</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span>  Flask,make_response,jsonify,abort,request</span><br><span class="line"><span class="keyword">from</span> flask_restful <span class="keyword">import</span>  Api,Resource</span><br><span class="line"><span class="keyword">from</span> flask_httpauth <span class="keyword">import</span>  HTTPBasicAuth</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"><span class="keyword">from</span> flask_jwt <span class="keyword">import</span> JWT, jwt_required, current_identity</span><br><span class="line"><span class="keyword">from</span> werkzeug.security <span class="keyword">import</span> safe_str_cmp</span><br><span class="line"></span><br><span class="line">app=Flask(__name__)</span><br><span class="line">app.debug = <span class="literal">True</span></span><br><span class="line">app.config[<span class="string">&#x27;SECRET_KEY&#x27;</span>] = <span class="string">&#x27;super-secret&#x27;</span></span><br><span class="line">api=Api(app=app)</span><br><span class="line">auth=HTTPBasicAuth()</span><br><span class="line"></span><br><span class="line"><span class="meta">@auth.get_password</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_password</span>(<span class="params">name</span>):</span><br><span class="line">   <span class="keyword">if</span> name==<span class="string">&#x27;admin&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&#x27;admin&#x27;</span></span><br><span class="line"><span class="meta">@auth.error_handler</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">authoorized</span>():</span><br><span class="line">   <span class="keyword">return</span> make_response(jsonify(&#123;<span class="string">&#x27;msg&#x27;</span>:<span class="string">&quot;请认证&quot;</span>&#125;),<span class="number">403</span>)</span><br><span class="line"></span><br><span class="line">books=[</span><br><span class="line">   &#123;<span class="string">&#x27;id&#x27;</span>:<span class="number">1</span>,<span class="string">&#x27;author&#x27;</span>:<span class="string">&#x27;wuya&#x27;</span>,<span class="string">&#x27;name&#x27;</span>:<span class="string">&#x27;Python接口自动化测试实战&#x27;</span>,<span class="string">&#x27;done&#x27;</span>:<span class="literal">True</span>&#125;,</span><br><span class="line">   &#123;<span class="string">&#x27;id&#x27;</span>:<span class="number">2</span>,<span class="string">&#x27;author&#x27;</span>:<span class="string">&#x27;无涯&#x27;</span>,<span class="string">&#x27;name&#x27;</span>:<span class="string">&#x27;Selenium3自动化测试实战&#x27;</span>,<span class="string">&#x27;done&#x27;</span>:<span class="literal">False</span>&#125;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">User</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">   <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, <span class="built_in">id</span>, username, password</span>):</span><br><span class="line">      self.<span class="built_in">id</span> = <span class="built_in">id</span></span><br><span class="line">      self.username = username</span><br><span class="line">      self.password = password</span><br><span class="line"></span><br><span class="line">   <span class="keyword">def</span> <span class="title function_">__str__</span>(<span class="params">self</span>):</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&quot;User(id=&#x27;%s&#x27;)&quot;</span> % self.<span class="built_in">id</span></span><br><span class="line"></span><br><span class="line">users = [</span><br><span class="line">   User(<span class="number">1</span>, <span class="string">&#x27;wuya&#x27;</span>, <span class="string">&#x27;asd888&#x27;</span>),</span><br><span class="line">   User(<span class="number">2</span>, <span class="string">&#x27;stage&#x27;</span>, <span class="string">&#x27;asd888&#x27;</span>),</span><br><span class="line">   User(<span class="number">3</span>,<span class="string">&#x27;line&#x27;</span>,<span class="string">&#x27;asd888&#x27;</span>)</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">username_table = &#123;u.username: u <span class="keyword">for</span> u <span class="keyword">in</span> users&#125;</span><br><span class="line">userid_table = &#123;u.<span class="built_in">id</span>: u <span class="keyword">for</span> u <span class="keyword">in</span> users&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">authenticate</span>(<span class="params">username, password</span>):</span><br><span class="line">   user = username_table.get(username, <span class="literal">None</span>)</span><br><span class="line">   <span class="keyword">if</span> user <span class="keyword">and</span> safe_str_cmp(user.password.encode(<span class="string">&#x27;utf-8&#x27;</span>), password.encode(<span class="string">&#x27;utf-8&#x27;</span>)):</span><br><span class="line">      <span class="keyword">return</span> user</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">identity</span>(<span class="params">payload</span>):</span><br><span class="line">   user_id = payload[<span class="string">&#x27;identity&#x27;</span>]</span><br><span class="line">   <span class="keyword">return</span> userid_table.get(user_id, <span class="literal">None</span>)</span><br><span class="line"></span><br><span class="line">jwt = JWT(app, authenticate, identity)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Books</span>(<span class="title class_ inherited__">Resource</span>):</span><br><span class="line">   decorators=[jwt_required()]</span><br><span class="line"></span><br><span class="line">   <span class="keyword">def</span> <span class="title function_">get</span>(<span class="params">self</span>):</span><br><span class="line">      <span class="keyword">return</span> jsonify(&#123;<span class="string">&#x27;status&#x27;</span>:<span class="number">0</span>,<span class="string">&#x27;msg&#x27;</span>:<span class="string">&#x27;ok&#x27;</span>,<span class="string">&#x27;datas&#x27;</span>:books&#125;)</span><br><span class="line"></span><br><span class="line">   <span class="keyword">def</span> <span class="title function_">post</span>(<span class="params">self</span>):</span><br><span class="line">      <span class="keyword">if</span> <span class="keyword">not</span> request.json:</span><br><span class="line">         <span class="keyword">return</span> jsonify(&#123;<span class="string">&#x27;status&#x27;</span>:<span class="number">1001</span>,<span class="string">&#x27;msg&#x27;</span>:<span class="string">&#x27;请求参数不是JSON的数据，请检查，谢谢！&#x27;</span>&#125;)</span><br><span class="line">      <span class="keyword">else</span>:</span><br><span class="line">         book = &#123;</span><br><span class="line">            <span class="string">&#x27;id&#x27;</span>: books[-<span class="number">1</span>][<span class="string">&#x27;id&#x27;</span>] + <span class="number">1</span>,</span><br><span class="line">            <span class="string">&#x27;author&#x27;</span>: request.json.get(<span class="string">&#x27;author&#x27;</span>),</span><br><span class="line">            <span class="string">&#x27;name&#x27;</span>: request.json.get(<span class="string">&#x27;name&#x27;</span>),</span><br><span class="line">            <span class="string">&#x27;done&#x27;</span>: <span class="literal">True</span></span><br><span class="line">         &#125;</span><br><span class="line">         books.append(book)</span><br><span class="line">         <span class="keyword">return</span> &#123;<span class="string">&#x27;status&#x27;</span>:<span class="number">1002</span>,<span class="string">&#x27;msg&#x27;</span>: <span class="string">&#x27;添加书籍成功&#x27;</span>,<span class="string">&#x27;datas&#x27;</span>:book&#125;</span><br><span class="line">         <span class="comment"># return jsonify(&#123;&#x27;status&#x27;:1002,&#x27;msg&#x27;: &#x27;添加书籍成功&#x27;,&#x27;datas&#x27;:book&#125;, 201)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Book</span>(<span class="title class_ inherited__">Resource</span>):</span><br><span class="line">   decorators = [jwt_required()]</span><br><span class="line"></span><br><span class="line">   <span class="keyword">def</span> <span class="title function_">get</span>(<span class="params">self,book_id</span>):</span><br><span class="line">      book = <span class="built_in">list</span>(<span class="built_in">filter</span>(<span class="keyword">lambda</span> t: t[<span class="string">&#x27;id&#x27;</span>] == book_id, books))</span><br><span class="line">      <span class="keyword">if</span> <span class="built_in">len</span>(book) == <span class="number">0</span>:</span><br><span class="line">         <span class="keyword">return</span> jsonify(&#123;<span class="string">&#x27;status&#x27;</span>: <span class="number">1003</span>, <span class="string">&#x27;msg&#x27;</span>: <span class="string">&#x27;很抱歉，您查询的书的信息不存在&#x27;</span>&#125;)</span><br><span class="line">      <span class="keyword">else</span>:</span><br><span class="line">         <span class="keyword">return</span> jsonify(&#123;<span class="string">&#x27;status&#x27;</span>: <span class="number">0</span>, <span class="string">&#x27;msg&#x27;</span>: <span class="string">&#x27;ok&#x27;</span>, <span class="string">&#x27;datas&#x27;</span>: book&#125;)</span><br><span class="line"></span><br><span class="line">   <span class="keyword">def</span> <span class="title function_">put</span>(<span class="params">self,book_id</span>):</span><br><span class="line">      book = <span class="built_in">list</span>(<span class="built_in">filter</span>(<span class="keyword">lambda</span> t: t[<span class="string">&#x27;id&#x27;</span>] == book_id, books))</span><br><span class="line">      <span class="keyword">if</span> <span class="built_in">len</span>(book) == <span class="number">0</span>:</span><br><span class="line">         <span class="keyword">return</span> jsonify(&#123;<span class="string">&#x27;status&#x27;</span>: <span class="number">1003</span>, <span class="string">&#x27;msg&#x27;</span>: <span class="string">&#x27;很抱歉，您查询的书的信息不存在&#x27;</span>&#125;)</span><br><span class="line">      <span class="keyword">elif</span> <span class="keyword">not</span> request.json:</span><br><span class="line">         <span class="keyword">return</span> jsonify(&#123;<span class="string">&#x27;status&#x27;</span>: <span class="number">1001</span>, <span class="string">&#x27;msg&#x27;</span>: <span class="string">&#x27;请求参数不是JSON的数据，请检查，谢谢！&#x27;</span>&#125;)</span><br><span class="line">      <span class="keyword">elif</span> <span class="string">&#x27;author&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> request.json:</span><br><span class="line">         <span class="keyword">return</span> jsonify(&#123;<span class="string">&#x27;status&#x27;</span>: <span class="number">1004</span>, <span class="string">&#x27;msg&#x27;</span>: <span class="string">&#x27;请求参数author不能为空&#x27;</span>&#125;)</span><br><span class="line">      <span class="keyword">elif</span> <span class="string">&#x27;name&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> request.json:</span><br><span class="line">         <span class="keyword">return</span> jsonify(&#123;<span class="string">&#x27;status&#x27;</span>: <span class="number">1005</span>, <span class="string">&#x27;msg&#x27;</span>: <span class="string">&#x27;请求参数name不能为空&#x27;</span>&#125;)</span><br><span class="line">      <span class="keyword">elif</span> <span class="string">&#x27;done&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> request.json:</span><br><span class="line">         <span class="keyword">return</span> jsonify(&#123;<span class="string">&#x27;status&#x27;</span>: <span class="number">1006</span>, <span class="string">&#x27;msg&#x27;</span>: <span class="string">&#x27;请求参数done不能为空&#x27;</span>&#125;)</span><br><span class="line">      <span class="keyword">elif</span> <span class="built_in">type</span>(request.json[<span class="string">&#x27;done&#x27;</span>])!=<span class="built_in">bool</span>:</span><br><span class="line">         <span class="keyword">return</span> jsonify(&#123;<span class="string">&#x27;status&#x27;</span>: <span class="number">1007</span>, <span class="string">&#x27;msg&#x27;</span>: <span class="string">&#x27;请求参数done为bool类型&#x27;</span>&#125;)</span><br><span class="line">      <span class="keyword">else</span>:</span><br><span class="line">         book[<span class="number">0</span>][<span class="string">&#x27;author&#x27;</span>] = request.json.get(<span class="string">&#x27;author&#x27;</span>, book[<span class="number">0</span>][<span class="string">&#x27;author&#x27;</span>])</span><br><span class="line">         book[<span class="number">0</span>][<span class="string">&#x27;name&#x27;</span>] = request.json.get(<span class="string">&#x27;name&#x27;</span>, book[<span class="number">0</span>][<span class="string">&#x27;name&#x27;</span>])</span><br><span class="line">         book[<span class="number">0</span>][<span class="string">&#x27;done&#x27;</span>] = request.json.get(<span class="string">&#x27;done&#x27;</span>, book[<span class="number">0</span>][<span class="string">&#x27;done&#x27;</span>])</span><br><span class="line">         <span class="keyword">return</span> jsonify(&#123;<span class="string">&#x27;status&#x27;</span>: <span class="number">1008</span>, <span class="string">&#x27;msg&#x27;</span>: <span class="string">&#x27;更新书的信息成功&#x27;</span>, <span class="string">&#x27;datas&#x27;</span>: book&#125;)</span><br><span class="line"></span><br><span class="line">   <span class="keyword">def</span> <span class="title function_">delete</span>(<span class="params">self,book_id</span>):</span><br><span class="line">      book = <span class="built_in">list</span>(<span class="built_in">filter</span>(<span class="keyword">lambda</span> t: t[<span class="string">&#x27;id&#x27;</span>] == book_id, books))</span><br><span class="line">      <span class="keyword">if</span> <span class="built_in">len</span>(book) == <span class="number">0</span>:</span><br><span class="line">         <span class="keyword">return</span> jsonify(&#123;<span class="string">&#x27;status&#x27;</span>: <span class="number">1003</span>, <span class="string">&#x27;msg&#x27;</span>: <span class="string">&#x27;很抱歉，您查询的书的信息不存在&#x27;</span>&#125;)</span><br><span class="line">      <span class="keyword">else</span>:</span><br><span class="line">         books.remove(book[<span class="number">0</span>])</span><br><span class="line">         <span class="keyword">return</span> jsonify(&#123;<span class="string">&#x27;status&#x27;</span>: <span class="number">1009</span>, <span class="string">&#x27;msg&#x27;</span>: <span class="string">&#x27;删除书籍成功&#x27;</span>&#125;)</span><br><span class="line"></span><br><span class="line">api.add_resource(Books,<span class="string">&#x27;/v1/api/books&#x27;</span>)</span><br><span class="line">api.add_resource(Book,<span class="string">&#x27;/v1/api/book/&lt;int:book_id&gt;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">   app.run(debug=<span class="literal">True</span>,host=<span class="string">&#x27;0.0.0.0&#x27;</span>,port=<span class="string">&#x27;5000&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>需要验证的测试场景为查询书籍，初始化是添加书籍，清理是删除书籍，编写的代码具体如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"><span class="comment">#author:无涯</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pytest</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@pytest.fixture()</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">token</span>():</span><br><span class="line">   r=requests.post(</span><br><span class="line">      url=<span class="string">&#x27;http://localhost:5000/auth&#x27;</span>,</span><br><span class="line">      json=&#123;<span class="string">&#x27;username&#x27;</span>:<span class="string">&#x27;wuya&#x27;</span>,<span class="string">&#x27;password&#x27;</span>:<span class="string">&#x27;asd888&#x27;</span>&#125;)</span><br><span class="line">   <span class="keyword">return</span> r.json()[<span class="string">&#x27;access_token&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="meta">@pytest.fixture()</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">headers</span>(<span class="params">token</span>):</span><br><span class="line">   <span class="keyword">return</span> &#123;<span class="string">&#x27;Authorization&#x27;</span>:<span class="string">&#x27;jwt &#123;0&#125;&#x27;</span>.<span class="built_in">format</span>(token)&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test_all_books</span>(<span class="params">headers</span>):</span><br><span class="line">   r=requests.get(</span><br><span class="line">      url=<span class="string">&#x27;http://localhost:5000/v1/api/books&#x27;</span>,</span><br><span class="line">      headers=headers)</span><br><span class="line">   <span class="built_in">print</span>(r.json())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">writeBook</span>(<span class="params">content</span>):</span><br><span class="line">   <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;bookID&#x27;</span>,<span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">      f.write(content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">addBook</span>(<span class="params">headers</span>):</span><br><span class="line">   r=requests.post(</span><br><span class="line">      url=<span class="string">&#x27;http://localhost:5000/v1/api/books&#x27;</span>,</span><br><span class="line">      json=&#123;<span class="string">&quot;name&quot;</span>:<span class="string">&quot;接⼝测试&quot;</span>,<span class="string">&quot;author&quot;</span>:<span class="string">&quot;⽆涯课堂&quot;</span>,<span class="string">&quot;done&quot;</span>:<span class="literal">True</span>&#125;,</span><br><span class="line">      headers=headers)</span><br><span class="line">   <span class="built_in">print</span>(<span class="string">&#x27;添加书籍:\n&#x27;</span>,r.json())</span><br><span class="line">   writeBook(<span class="built_in">str</span>(r.json()[<span class="string">&#x27;datas&#x27;</span>][<span class="string">&#x27;id&#x27;</span>]))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">bookID</span>():</span><br><span class="line">   <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;bookID&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">      <span class="keyword">return</span> f.read()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">delBook</span>(<span class="params">headers</span>):</span><br><span class="line">   r=requests.delete(</span><br><span class="line">      url=<span class="string">&#x27;http://localhost:5000/v1/api/book/&#123;0&#125;&#x27;</span>.<span class="built_in">format</span>(bookID()),</span><br><span class="line">      headers=headers)</span><br><span class="line">   <span class="built_in">print</span>(<span class="string">&#x27;删除书籍:\n&#x27;</span>,r.json())</span><br><span class="line"></span><br><span class="line"><span class="meta">@pytest.fixture()</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">apiInit</span>(<span class="params">headers</span>):</span><br><span class="line">   addBook(headers)</span><br><span class="line">   <span class="keyword">yield</span></span><br><span class="line">   delBook(headers)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test_query_book</span>(<span class="params">apiInit,headers</span>):</span><br><span class="line">   r=requests.get(</span><br><span class="line">      url=<span class="string">&#x27;http://127.0.0.1:5000/v1/api/book/&#123;0&#125;&#x27;</span>.<span class="built_in">format</span>(bookID()),</span><br><span class="line">      headers=headers)</span><br><span class="line">   <span class="built_in">print</span>(<span class="string">&#x27;获取添加的书籍信息:\n&#x27;</span>,r.json())</span><br><span class="line">   <span class="keyword">assert</span> r.json()[<span class="string">&#x27;datas&#x27;</span>][<span class="number">0</span>][<span class="string">&#x27;id&#x27;</span>]==<span class="built_in">int</span>(bookID())</span><br></pre></td></tr></table></figure>

<p>在如上代码中定义的Fixture函数名称为apiInit，初始化代码为添加书籍的方法addBook，清理代码是删除书籍delBook方法，这样在每次执行测试函数test_query_book的时候第一步是添加书籍，第二步骤是查询书籍并且验证查询的结果信息，最后一步是清理添加的数据，这样的目的是为了保持编写的测试用例的独立性。其实本质上而言，只要深刻理解了测试固件的特性，再结合上面的案例，就很好理解Fixture函数测试固件的特性。</p>
<h1 id="Fixture返回值特性"><a href="#Fixture返回值特性" class="headerlink" title="Fixture返回值特性"></a>Fixture返回值特性</h1><p>Fixture函数另外一个特性是返回值的特性，这个特性可以很好的应用在API测试中关于授权认证的部分。在API测试中首先需要获取到TOKEN，然后再下个请求中带上登录成功后返回的TOKEN，那么结合Fixture返回值的特性，可以很轻松的来解决这部分。详细的实战代码见如下:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"><span class="comment"># author:无涯</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span>  pytest</span><br><span class="line"><span class="keyword">import</span>  requests</span><br><span class="line"></span><br><span class="line"><span class="meta">@pytest.fixture()</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login</span>():</span><br><span class="line">  r=requests.post(</span><br><span class="line">    url=<span class="string">&#x27;http://0.0.0.0:8000/login/auth/&#x27;</span>,</span><br><span class="line">    json=&#123;<span class="string">&quot;username&quot;</span>:<span class="string">&quot;13484545195&quot;</span>,<span class="string">&quot;password&quot;</span>:<span class="string">&quot;asd888&quot;</span>&#125;,</span><br><span class="line">    headers=&#123;<span class="string">&#x27;Content-Type&#x27;</span>:<span class="string">&quot;application/json&quot;</span>&#125;)</span><br><span class="line">  <span class="keyword">return</span> r.json()[<span class="string">&#x27;token&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test_index</span>(<span class="params">login</span>):</span><br><span class="line">  r=requests.get(</span><br><span class="line">    url=<span class="string">&#x27;http://0.0.0.0:8000/interface/index&#x27;</span>,</span><br><span class="line">    headers=&#123;<span class="string">&#x27;Authorization&#x27;</span>:<span class="string">&#x27;JWT &#123;login&#125;&#x27;</span>.<span class="built_in">format</span>(login=login)&#125;)</span><br><span class="line">  <span class="keyword">assert</span> r.status_code==<span class="number">200</span></span><br></pre></td></tr></table></figure>

<p>在测试函数test_index中形式参数login其实就是Fixture函数login的对象，那么Fixture函数返回值的内容其实就是该函数对象的值，见debug模式下显示的信息。  <img src="/2024/05/08/Pytest%E6%B5%8B%E8%AF%95%E6%A1%86%E6%9E%B6%E4%B9%8BFixture%E8%AF%A6%E8%A7%A3/%E8%BF%94%E5%9B%9E%E5%80%BC%E7%89%B9%E6%80%A7.jpg" alt="返回值特性"></p>
<p>其实要深刻的理解这部分，首先还是需要理解在Python中一切皆对象这个设计思想，这个设计思想中的对象它可以是一个变量，或者是一个函数，或者是一个类。在这个案例中，对象login它就是一个函数，是Fixture函数login的对象。</p>
<h1 id="Fixture的重命名"><a href="#Fixture的重命名" class="headerlink" title="Fixture的重命名"></a>Fixture的重命名</h1><p>在Pytest测试框架中也可以对Fixture函数进行重命名，˙这样在调用的时候直接使用重命名后的名称。Fixture函数中重命名的关键字是name，实现的案例代码如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"><span class="comment"># author:无涯</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span>  pytest</span><br><span class="line"><span class="keyword">import</span>  requests</span><br><span class="line"></span><br><span class="line"><span class="meta">@pytest.fixture(<span class="params">name=<span class="string">&#x27;token&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login</span>():</span><br><span class="line">  r=requests.post(</span><br><span class="line">    url=<span class="string">&#x27;http://0.0.0.0:8000/login/auth/&#x27;</span>,</span><br><span class="line">    json=&#123;<span class="string">&quot;username&quot;</span>:<span class="string">&quot;13484545195&quot;</span>,<span class="string">&quot;password&quot;</span>:<span class="string">&quot;asd888&quot;</span>&#125;,</span><br><span class="line">    headers=&#123;<span class="string">&#x27;Content-Type&#x27;</span>:<span class="string">&quot;application/json&quot;</span>&#125;)</span><br><span class="line">  <span class="keyword">return</span> r.json()[<span class="string">&#x27;token&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test_index</span>(<span class="params">token</span>):</span><br><span class="line">  r=requests.get(</span><br><span class="line">    url=<span class="string">&#x27;http://0.0.0.0:8000/interface/index&#x27;</span>,</span><br><span class="line">    headers=&#123;<span class="string">&#x27;Authorization&#x27;</span>:<span class="string">&#x27;JWT &#123;login&#125;&#x27;</span>.<span class="built_in">format</span>(login=token)&#125;)</span><br><span class="line">  <span class="keyword">assert</span> r.status_code==<span class="number">200</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">  pytest.main([<span class="string">&quot;-s&quot;</span>,<span class="string">&quot;-v&quot;</span>,<span class="string">&quot;test_fixture.py&quot;</span>])</span><br></pre></td></tr></table></figure>

<h1 id="指定Fixture作用范围"><a href="#指定Fixture作用范围" class="headerlink" title="指定Fixture作用范围"></a>指定Fixture作用范围</h1><p>Fixture中包含一个scope的关键字可以指定Fixture函数的作用范围，主要用于控制Fixture函数执行前置与执行后置的频率，作用范围分别是function、class、module、session，如果编写的Fixture函数没指定scope默认是function，下面针对不同作用范围详细的阐述下，具体如下：</p>
<ul>
<li>function：函数级别的Fixture在每个测试函数只运行一次。</li>
<li>class：类级别的scope不管测试类中有多少个测试方法，都可以共享这个Fixture并且每个测试类只执行一次。</li>
<li>module：每个模块只需要执行一次，不管这个模块里面有多少个测试类与测试函数。</li>
<li>session：会话级别的Fixture每次会话只需要执行一次，在一个Pytest会话中所有的测试函数(测试方法)都共享这个。</li>
</ul>
<p>那么涉及到一个问题，在企业级里面使用的时候按那个scope范围来使用了，我的建议是按默认的作用范围来使用就可以了。</p>
<h1 id="Fixture的参数化"><a href="#Fixture的参数化" class="headerlink" title="Fixture的参数化"></a>Fixture的参数化</h1><p>使用Fixture也可以实现参数化，在Fixture中使用param关键字获取到需要参数化的数据，Fixture参数化案例代码如下:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"><span class="comment"># author:无涯</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span>  pytest</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">a,b</span>):</span><br><span class="line">  <span class="keyword">return</span> a+b</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">data</span>():</span><br><span class="line">  <span class="keyword">return</span> [</span><br><span class="line">  &#123;<span class="string">&quot;x&quot;</span>:<span class="number">1</span>,<span class="string">&quot;y&quot;</span>:<span class="number">4</span>,<span class="string">&quot;result&quot;</span>:<span class="number">5</span>&#125;,</span><br><span class="line">  &#123;<span class="string">&quot;x&quot;</span>:<span class="string">&quot;wuya&quot;</span>,<span class="string">&quot;y&quot;</span>:<span class="string">&quot;Share&quot;</span>,<span class="string">&quot;result&quot;</span>:<span class="string">&quot;wuyaShare&quot;</span>&#125;,</span><br><span class="line">  &#123;<span class="string">&quot;x&quot;</span>:<span class="number">1.0</span>,<span class="string">&quot;y&quot;</span>:<span class="number">4.0</span>,<span class="string">&quot;result&quot;</span>:<span class="number">5.0</span>&#125;,</span><br><span class="line">  &#123;<span class="string">&quot;x&quot;</span>:<span class="number">1</span>,<span class="string">&quot;y&quot;</span>:<span class="number">4.0</span>,<span class="string">&quot;result&quot;</span>:<span class="number">5.0</span>&#125;,</span><br><span class="line">  &#123;<span class="string">&quot;x&quot;</span>:[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>],<span class="string">&quot;y&quot;</span>:[<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>],<span class="string">&quot;result&quot;</span>:[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>]&#125;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="meta">@pytest.fixture(<span class="params">params=data(<span class="params"></span>)</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getData</span>(<span class="params">request</span>):</span><br><span class="line">  <span class="keyword">return</span> request.param</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test_add_fixture_params</span>(<span class="params">getData</span>):</span><br><span class="line">  <span class="keyword">assert</span> add(a=getData[<span class="string">&#x27;x&#x27;</span>],b=getData[<span class="string">&#x27;y&#x27;</span>])==getData[<span class="string">&#x27;result&#x27;</span>]</span><br></pre></td></tr></table></figure>

<p>如上所示可以看到在getData函数中通过param关键字获取到参数化的数据，然后在测试函数中getData可以依次获取里面的数据，如上代码执行后的结果信息如下所示。</p>
<p><img src="/2024/05/08/Pytest%E6%B5%8B%E8%AF%95%E6%A1%86%E6%9E%B6%E4%B9%8BFixture%E8%AF%A6%E8%A7%A3/%E5%8F%82%E6%95%B0%E5%8C%96.jpg" alt="参数化"></p>
<p>在Pytest测试框架中Fixture函数具备很强大的特性，上面分别从传递测试数据、测试固件、重命名、参数化等方面进行了详细的阐述。掌握这些特性能够解决在企业中自动化测试的事宜。</p>
<p>感谢您的阅读！服务端测试开发技术已经成为测试工程师、测试开发工程师成为高薪必备的测试开发技能，越早掌握，越能占得红利。本课程带您从零到一构建服务端测试开发知识体系，并引入了业界主流的测试开发技术栈体系(微服务架构,MQ消息队列,DevOps,性能测试,混沌工程等)，整合业内主流的测试开发技术，带您打通高薪测试开发工程师需要具备的软实力和测试开工技术的任督二脉，点击如下链接购买，与众多测试开发工程师一起进阶。</p>
<p><a target="_blank" rel="noopener" href="https://study.163.com/course/introduction/1212497802.htm">https://study.163.com/course/introduction/1212497802.htm</a></p>
<p>《Python服务端测试开发》书籍已出版，书籍主要面向想系统、全栈学习服务端测试开发领域内的测试工程师，读者包含但不限于软件测试工程师、自动化测试工程师、测试开发工程师和测试管理者。通过本书您将会学习到服务端测试领域测试开发技术栈知识，包含了API测试框架设计思想与案例实战，Docker容器化技术，基于DevOps体系下的CI&#x2F;CD技术栈知识体系，CI&#x2F;CD技术在企业的技术落地案例，服务端测试开发领域的性能测试核心理论、方法论、流程化和主流性能测试在服务端的最佳实践、性能测试过程中全链路监控与分布式追踪监控技术解决方案，JVM性能分析与案例监控实践。同时您也会学习到微服务架构下质量体系建设，混沌工程实践，和针对底层高可用系统的保障技术思路。点击如下链接购买。</p>
<p><a target="_blank" rel="noopener" href="https://product.dangdang.com/29701404.html">https://product.dangdang.com/29701404.html</a></p>
<p>关注“Python自动化测试”公众号，阅读更多测试开发技术文章，与众多测试开发工程师一起进步。</p>
<p><img src="/2024/05/08/Pytest%E6%B5%8B%E8%AF%95%E6%A1%86%E6%9E%B6%E4%B9%8BFixture%E8%AF%A6%E8%A7%A3/%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%8F%B7.jpg" alt="微信公众号"></p>

        </div>
    
<!-- tags -->

    <div class="post-meta">
        标签：
        
            <a href="/tags/Pytest%E6%B5%8B%E8%AF%95%E6%A1%86%E6%9E%B6/"> / Pytest测试框架</a>
        
    </div>

</div>
                <div class="footer">
    <span>Copyright © 2024 无涯博客</span>
    <span>Powered by <a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a> with <a target="_blank" rel="noopener" href="https:///imzl.com/zenmind">无涯</a></span>
</div>

<link rel="stylesheet" href="/css/a11y-dark.min.css">


<script src="/js/highlight.min.js"></script>


<script src="/js/highlightjs-line-numbers.js"></script>

<script>
    hljs.initHighlightingOnLoad();
    hljs.initLineNumbersOnLoad();
</script>

            </div>
        </div>
    </body>
</html>